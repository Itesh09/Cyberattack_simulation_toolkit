import subprocess
import os
from time import sleep

def nmap_vuln_scan(target):
    """Automated Nmap vulnerability scan using NSE scripts."""
    print(f"\n[+] Running Nmap vulnerability scan on {target}...")
    # Example: nmap -sV --script=vulners.nse <target>
    subprocess.run([
        "nmap", "-sV", "--script=vulners.nse", target
    ])

def searchsploit_exploits(query):
    """Search for exploits using Searchsploit."""
    print(f"\n[+] Searching exploits for: {query}")
    # Example: searchsploit <query>
    subprocess.run([
        "searchsploit", query
    ])

def nikto_scan(target):
    """Run Nikto web vulnerability scanner."""
    print(f"\n[+] Scanning {target} with Nikto...")
    # Example: nikto -h <target>
    subprocess.run([
        "nikto", "-h", target
    ])

def wpscan_scan(target):
    """Scan WordPress sites for vulnerabilities."""
    print(f"\n[+] Scanning WordPress site at {target}...")
    # Example: wpscan --url <target> --enumerate p,t,u
    subprocess.run([
        "wpscan", "--url", target, "--enumerate", "p,t,u"
    ])

def vulnerability_scanner_menu():
    """Vulnerability Scanner submenu."""
    while True:
        print("\n=== Vulnerability Scanner ===")
        print("1) Nmap Vulnerability Scan (NSE)")
        print("2) Searchsploit (Find Exploits)")
        print("3) Nikto (Web Server Scanner)")
        print("4) WPScan (WordPress Scanner)")
        print("5) Back to Main Menu")
        choice = input("Select an option: ")

        if choice == "1":
            target = input("Enter target IP/hostname: ")
            nmap_vuln_scan(target)
        elif choice == "2":
            query = input("Enter search query (e.g., 'Apache 2.4.49'): ")
            searchsploit_exploits(query)
        elif choice == "3":
            target = input("Enter target URL (e.g., http://example.com): ")
            nikto_scan(target)
        elif choice == "4":
            target = input("Enter WordPress site URL (e.g., http://example.com): ")
            wpscan_scan(target)
        elif choice == "5":
            break
        else:
            print("[-] Invalid option. Try again.")
        sleep(1)  # Pause for readability